<div class="container">
  <aside class="filters-card rounded-card" *ngIf="isDesktop">
    <!-- Desktop searchbar -->
    <div class="rounded-search-bar box-shadow-2">
      <input type="search" [formControl]="searchControl" placeholder="Buscar" (keyup.enter)="doSearch(1)">
      <button *ngIf="!!searchParams.search && searchParams.search === searchControl.value" mat-icon-button (click)="clearSearchControl()">
        <mat-icon>close</mat-icon>
      </button>
      <button *ngIf="!!!searchParams.search || searchParams.search !== searchControl.value" mat-icon-button (click)="doSearch(1)">
        <mat-icon>search</mat-icon>
      </button>
    </div>

    <mat-divider></mat-divider>
  
    <!-- Desktop filters -->
    <div class="filters__selects">
      <app-rounded-select
        class="bg-text-academic-level box-shadow-2"
        baseText="Nivel Académico"
        [control]="academicLevelControl"
        [options]="academicLevelsList"
        [resetButton]="true"
        [loading]="isAcademicLevelsLoading">
      </app-rounded-select>
      <app-rounded-select
        class="bg-text-axis box-shadow-2"
        baseText="Eje"
        [control]="axisControl"
        [hasGroups]="true"
        [options]="subjectWithAxis"
        [searchInput]="true"
        searchPlaceholder="Busca un eje o asignatura"
        [resetButton]="true"
        [loading]="isAxesLoading">
      </app-rounded-select>
      <app-rounded-select
        class="bg-text-subject box-shadow-2"
        baseText="Asignatura"
        [control]="subjectControl"
        [options]="subjectList"
        [searchInput]="true"
        searchPlaceholder="Busca una asignatura"
        [resetButton]="true"
        [loading]="isSubjectsLoading">
      </app-rounded-select>
      <app-rounded-select
        class="bg-text-blue-white box-shadow-2"
        baseText="Ordenar por"
        [control]="orderingControl"
        [options]="orderingList">
      </app-rounded-select>
  
      <button class="reset-filters-button" *ngIf="showRemoveFilters" (click)="clearFilterControls()">
        <mat-icon class="small-icon">delete</mat-icon>
        <span class="fw-600">Borrar filtros</span>
      </button>
    </div>
  </aside>
  
  <div>
    <div class="fs-small flex-end-center flex-wrap gap-05">
      <button class="filters-button rounded-button-slim box-shadow-1" *ngIf="!this.isDesktop">
        <span>Filtros y búsqueda</span>
        <mat-icon class="small-icon">filter_alt</mat-icon>
      </button>

      <!-- Filter tags -->
      <div class="filter-tags flex-center-center gap-025 flex-wrap">
        <button class="rounded-button-slim bg-text-academic-level box-shadow-1">
          <span>6to Básico</span>
          <mat-icon class="small-icon">close</mat-icon>
        </button>
        <button class="rounded-button-slim bg-text-axis box-shadow-1">
          <span>Lectura</span>
          <mat-icon class="small-icon">close</mat-icon>
        </button>
        <button class="rounded-button-slim bg-text-subject box-shadow-1">
          <span>Lenguaje y comunicación</span>
          <mat-icon class="small-icon">close</mat-icon>
        </button>
        <button class="rounded-button-slim bg-text-blue-white box-shadow-1">
          <span>Más recientes</span>
          <mat-icon class="small-icon">close</mat-icon>
        </button>
      </div>
    
      <!-- Paginations -->
      <div class="pagination flex-center-center gap-05">
        <span class="fw-700 fs-regular">
          {{ (pageInfo?.maxPage ?? 0) * (searchParams.page! - 1) + 1 }}
           - {{ (pageInfo?.maxPage ?? 0) * (searchParams.page! - 1) + posts.length }}
          de {{ pageInfo?.count }}
        </span>
        <div class="flex-center-center gap-025">
          <button class="circle-button" (click)="previousPage()" [disabled]="!pageInfo?.previous || isLoading">
            <mat-icon class="small-icon">navigate_before</mat-icon>
          </button>
          <button class="circle-button" [matMenuTriggerFor]="pagesMenu">
            <span class="fs-small fw-700">{{ searchParams.page }}</span>
          </button>
          <mat-menu #pagesMenu>
            <button mat-menu-item *ngFor="let page of (pageInfo?.maxPage ?? 1)|fillArray" (click)="doSearch(page)">
              {{ page }}
            </button>
          </mat-menu>
          <button class="circle-button" (click)="nextPage()" [disabled]="!pageInfo?.next || isLoading">
            <mat-icon class="small-icon">navigate_next</mat-icon>
          </button>
        </div>
      </div>
    </div>

    <!-- Post grid -->
    <section class="posts-grid">
      <div class="rounded-card flex-column gap-1" *ngFor="let post of posts">
        <div class="flex-space_between-center">
          <p>{{ post.user.fullName }} - {{ post.createdAt|timeAgo }}</p>
          <mat-icon class="text-blue-dark">more_vert</mat-icon>
        </div>
  
        <div>
          <h2>{{ post.title }}</h2>
          <p>{{ post.shortDescription }}</p>
        </div>
  
        <div class="flex-space_between-center flex-wrap gap-025">
          <div class="flex-center-center gap-025">
            <mat-icon class="text-blue-dark">description</mat-icon>
            <span class="fw-600">{{ post.totalFiles }} Documentos</span>
          </div>
  
          <div class="flex-wrap gap-025">
            <span class="small-border-tag-{{ post.mainFile.tagColor }}">{{ post.mainFile.ext }}</span>
            <ng-container *ngFor="let file of post.suportingMaterial">
              <span class="small-border-tag-{{ file.tagColor }}">{{ file.ext }}</span>
            </ng-container>
          </div>
        </div>
  
        <div class="flex-wrap gap-025">
          <span class="rounded-button-slim bg-text-academic-level">Nivel académico: {{ post.academicLevel.name }}</span>
          <span class="rounded-button-slim bg-text-axis">Eje: {{ post.axis.name }}</span>
          <span class="rounded-button-slim bg-text-subject">Asignatura: {{ post.axis.subject.name }}</span>
        </div>
  
        <div class="flex-space_between-center">
          <div class="flex-center-center gap-1">
            <div class="flex-center-center gap-025">
              <mat-icon class="small-icon text-blue-dark">favorite_outline</mat-icon>
              <span class="fw-600">{{ post.totalLikes }} Me gusta</span>
            </div>
            <div class="flex-center-center gap-025">
              <mat-icon class="small-icon text-blue-dark">visibility</mat-icon>
              <span class="fw-600">{{ post.totalLikes }} Visualizaciones</span>
            </div>
          </div>
  
          <mat-icon class="text-red">
            {{ post.alreadyLiked ? 'favorite' : 'favorite_outline' }}
          </mat-icon>
        </div>
      </div>
    </section>
  </div>
</div>
  